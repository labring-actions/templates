apiVersion: template.app.sealos.io/v1beta1
kind: Template
metadata:
  name: ${{ defaults.app_name }}
spec:
  title: 'Dify'
  url: 'https://cloud.dify.ai'
  readme: 'https://raw.githubusercontent.com/langgenius/dify/main/README.md'
  icon: 'https://avatars.githubusercontent.com/u/127165244?s=48&v=4'
  template_type: inline
  defaults:
    ingress_name:
      # number or string.
      type: string
      value: ${{ random(8) }}
    app_name:
      type: string
      value: dify-${{ random(8) }}
  inputs:
    volume_size:
      description: 'save data size (Gi)'
      # boolean, choice, number, or string.
      type: string
      default: '1'
      required: false


# Startup mode, 'api' starts the API server.
MODE:api
# The log level for the application. Supported values are `DEBUG`, `INFO`, `WARNING`, `ERROR`, `CRITICAL`
LOG_LEVEL:INFO
# A secret key that is used for securely signing the session cookie and encrypting sensitive information on the database. You can generate a strong key using `openssl rand -base64 42`.
SECRET_KEY:sk-9f73s3ljTXVcMT3Blb3ljTqtsKiGHXVcMT3BlbkFJLK7U
# The base URL of console application, refers to the Console base URL of WEB service if console domain is
# different from api or web app domain.
# example: http://cloud.dify.ai
CONSOLE_URL:''
# The URL for Service API endpointsï¼Œrefers to the base URL of the current API service if api domain is
# different from console domain.
# example: http://api.dify.ai
API_URL:''
# The URL for Web APP, refers to the Web App base URL of WEB service if web app domain is different from
# console or api domain.
# example: http://udify.app
APP_URL:''
# When enabled, migrations will be executed prior to application startup and the application will start after the migrations have completed.
MIGRATION_ENABLED:'true'
# The configurations of postgres database connection.
# It is consistent with the configuration in the 'db' service below.
DB_USERNAME:postgres
DB_PASSWORD:difyai123456
DB_HOST:db
DB_PORT:5432
DB_DATABASE:dify
# The configurations of redis connection.
# It is consistent with the configuration in the 'redis' service below.
REDIS_HOST:redis
REDIS_PORT:6379
REDIS_USERNAME:''
REDIS_PASSWORD:difyai123456
REDIS_USE_SSL:'false'
# use redis db 0 for redis cache
REDIS_DB:0
# The configurations of session, Supported values are `sqlalchemy`. `redis`
SESSION_TYPE:redis
SESSION_REDIS_HOST:redis
SESSION_REDIS_PORT:6379
SESSION_REDIS_USERNAME:''
SESSION_REDIS_PASSWORD:difyai123456
SESSION_REDIS_USE_SSL:'false'
# use redis db 2 for session store
SESSION_REDIS_DB:2
# The configurations of celery broker.
# Use redis as the broker, and redis db 1 for celery broker.
CELERY_BROKER_URL:redis://:difyai123456@redis:6379/1
# Specifies the allowed origins for cross-origin requests to the Web API, e.g. https://dify.app or * for all origins.
WEB_API_CORS_ALLOW_ORIGINS:'*'
# Specifies the allowed origins for cross-origin requests to the console API, e.g. https://cloud.dify.ai or * for all origins.
CONSOLE_CORS_ALLOW_ORIGINS:'*'
# CSRF Cookie settings
# Controls whether a cookie is sent with cross-site requests,
# providing some protection against cross-site request forgery attacks
#
# Default: `SameSite=Lax, Secure=false, HttpOnly=true`
# This default configuration supports same-origin requests using either HTTP or HTTPS,
# but does not support cross-origin requests. It is suitable for local debugging purposes.
#
# If you want to enable cross-origin support,
# you must use the HTTPS protocol and set the configuration to `SameSite=None, Secure=true, HttpOnly=true`.
#
# For **production** purposes, please set `SameSite=Lax, Secure=true, HttpOnly=true`.
COOKIE_HTTPONLY:'true'
COOKIE_SAMESITE:'Lax'
COOKIE_SECURE:'false'
# The type of storage to use for storing user files. Supported values are `local` and `s3`, Default: `local`
STORAGE_TYPE:local
# The path to the local storage directory, the directory relative the root path of API service codes or absolute path. Default: `storage` or `/home/john/storage`.
# only available when STORAGE_TYPE is `local`.
STORAGE_LOCAL_PATH:storage
# The S3 storage configurations, only available when STORAGE_TYPE is `s3`.
S3_ENDPOINT:'https://xxx.r2.cloudflarestorage.com'
S3_BUCKET_NAME:'difyai'
S3_ACCESS_KEY:'ak-difyai'
S3_SECRET_KEY:'sk-difyai'
S3_REGION:'us-east-1'
# The type of vector store to use. Supported values are `weaviate`, `qdrant`.
VECTOR_STORE:weaviate
# The Weaviate endpoint URL. Only available when VECTOR_STORE is `weaviate`.
WEAVIATE_ENDPOINT:http://weaviate:8080
# The Weaviate API key.
WEAVIATE_API_KEY:WVF5YThaHlkYwhGUSmCRgsX3tD5ngdN8pkih
# The Qdrant endpoint URL. Only available when VECTOR_STORE is `qdrant`.
QDRANT_URL:'https://your-qdrant-cluster-url.qdrant.tech/'
# The Qdrant API key.
QDRANT_API_KEY:'ak-difyai'
# The DSN for Sentry error reporting. If not set, Sentry error reporting will be disabled.
SENTRY_DSN:''
# The sample rate for Sentry events. Default: `1.0`
SENTRY_TRACES_SAMPLE_RATE:1.0
# The sample rate for Sentry profiles. Default: `1.0`
SENTRY_PROFILES_SAMPLE_RATE:1.0
volumes:
# Mount the storage directory to the container, for storing user files.
- ./volumes/app/storage:/app/api/storage

